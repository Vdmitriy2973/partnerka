{% load static %}
<!-- Модальное окно -->
<dialog id="paymentModal" class="modal modal-bottom sm:modal-middle">
  <div class="modal-box max-w-2xl p-0 overflow-hidden max-h-[90vh] flex flex-col">
    <!-- Заголовок -->
    <div class="sticky top-0 bg-base-100 p-6 pb-4 border-b border-base-200 z-10">
      <div class="flex justify-between items-center">
        <h3 class="text-xl font-bold">Создать выплату</h3>
        <button onclick="paymentModal.close()" class="btn btn-circle btn-ghost btn-sm">
          ✕
        </button>
      </div>
    </div>

    <!-- Основное содержимое -->
    <div class="flex-1 overflow-y-auto p-6">
      <!-- Поиск партнёра -->
      <div class="mb-6">
        <label class="label">
          <span class="label-text">Поиск партнёра</span>
        </label>
        <div class="relative">
          <input 
            type="text" 
            id="partnerSearch" 
            placeholder="Введите имя, email или ID..." 
            class="input input-bordered w-full pl-10"
          >
          <span class="absolute left-3 top-1/2 transform -translate-y-1/2">
            <i class="fas fa-search text-gray-400"></i>
          </span>
        </div>
        <div id="partnerList" class="mt-2 border rounded-lg max-h-60 overflow-y-auto hidden">
          <!-- Список будет заполняться JavaScript -->
        </div>
      </div>

      <!-- Выбранный партнёр -->
      <div id="selectedPartnerContainer" class="hidden mb-6 p-4 bg-base-200 rounded-lg">
        <div class="flex justify-between items-center">
          <div>
            <h4 class="font-bold" id="selectedPartnerName"></h4>
            <p class="text-sm opacity-70" id="selectedPartnerDetails"></p>
          </div>
          <button onclick="clearPartnerSelection()" class="btn btn-ghost btn-sm">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <!-- Сумма выплаты -->
      <div class="mb-6">
        <label class="label">
          <span class="label-text">Сумма выплаты</span>
        </label>
        <div class="relative">
          <span class="absolute inset-y-0 left-0 flex items-center pl-3">₽</span>
          <input 
            type="number" 
            id="paymentAmount" 
            placeholder="0.00" 
            class="input input-bordered w-full pl-8"
            min="0"
            step="0.01"
          >
        </div>
      </div>

      <!-- Способ выплаты -->
      <div class="mb-6">
        <label class="label">
          <span class="label-text">Способ выплаты</span>
        </label>
        <div class="grid grid-cols-2 sm:grid-cols-4 gap-2">
          <button class="payment-method-btn btn btn-outline btn-sm sm:btn-md" data-method="card">
            <i class="fas fa-credit-card mr-2"></i> Карта
          </button>
          <button class="payment-method-btn btn btn-outline btn-sm sm:btn-md" data-method="bank">
            <i class="fas fa-university mr-2"></i> Банк
          </button>
          <button class="payment-method-btn btn btn-outline btn-sm sm:btn-md" data-method="paypal">
            <i class="fab fa-paypal mr-2"></i> PayPal
          </button>
          <button class="payment-method-btn btn btn-outline btn-sm sm:btn-md" data-method="crypto">
            <i class="fas fa-wallet mr-2"></i> Крипто
          </button>
        </div>
        <input type="hidden" id="paymentMethod">
      </div>

      <!-- Комментарий -->
      <div>
        <label class="label">
          <span class="label-text">Комментарий (необязательно)</span>
        </label>
        <textarea 
          id="paymentComment" 
          class="textarea textarea-bordered w-full" 
          placeholder="Укажите детали выплаты..."
          rows="3"
        ></textarea>
      </div>
    </div>

    <!-- Футер -->
    <div class="sticky bottom-0 bg-base-100 p-6 pt-4 border-t border-base-200">
      <div class="flex flex-col sm:flex-row gap-3">
        <button onclick="paymentModal.close()" class="btn btn-ghost flex-1">
          Отменить
        </button>
        <button 
          id="submitPaymentBtn" 
          class="btn btn-primary flex-1"
          disabled
        >
          <i class="fas fa-paper-plane mr-2"></i> Создать выплату
        </button>
      </div>
    </div>
  </div>

  <!-- Фон модального окна -->
    <form method="dialog" class="modal-backdrop backdrop-blur-sm bg-black/30 transition-opacity duration-300
                           opacity-0 [dialog[open]_&]:opacity-100">
        <button>close</button>
    </form>
</dialog>